# AtAllFilter 插件

## 插件介绍

AtAllFilter 是一个用于过滤群聊中"@所有人"消息的插件。当在群聊中收到包含"@所有人"或"@全体成员"的消息时，该插件会阻止消息传递到其他插件，避免机器人对这类消息做出响应。

## 功能特点

- 高优先级处理，确保在其他插件之前过滤消息
- 支持检测多种"@所有人"的形式：
  - 消息内容中包含"@所有人"或"@全体成员"
  - 消息的@列表中包含"所有人"或"全体成员"
  - 消息源中包含"notify@all"标记
- 可配置是否记录被过滤的消息
- 支持过滤文本消息、@消息和 XML 消息

## 配置选项

插件的配置文件位于 `plugins/AtAllFilter/config.toml`，包含以下配置选项：

```toml
[basic]
enable = true  # 是否启用插件

[filter]
# 是否记录被过滤的消息
log_filtered = true
```

### 配置说明

- `enable`: 控制插件是否启用，设置为 `true` 启用，`false` 禁用
- `log_filtered`: 控制是否记录被过滤的消息，设置为 `true` 记录，`false` 不记录

## 工作原理

1. 插件注册了三个高优先级的事件处理函数，分别处理文本消息、@消息和 XML 消息
2. 当收到消息时，插件会检查消息是否包含"@所有人"或"@全体成员"
3. 如果检测到"@所有人"消息，插件会返回 `False`，阻止消息继续传递到其他插件
4. 如果消息不包含"@所有人"，插件会返回 `True`，允许消息继续传递

## 使用示例

### 基本使用

1. 确保插件已启用（`enable = true`）
2. 当在群聊中收到"@所有人"消息时，插件会自动过滤，机器人不会对这类消息做出响应

### 禁用日志记录

如果您不希望在日志中记录被过滤的消息，可以修改配置文件：

```toml
[basic]
enable = true

[filter]
log_filtered = false  # 设置为false禁用日志记录
```

## 注意事项

- 该插件仅过滤群聊中的"@所有人"消息，不会影响私聊消息
- 插件使用高优先级（100）确保在其他插件之前处理消息，如果有其他插件也使用了相同或更高的优先级，可能会影响过滤效果
- 如果您希望机器人对某些特定的"@所有人"消息做出响应，可能需要修改插件代码或禁用该插件

## 版本历史

- v1.0.0: 初始版本，支持过滤群聊中的"@所有人"消息

## 作者信息

- 作者: xxxbot-pad
- 版本: 1.0.0
